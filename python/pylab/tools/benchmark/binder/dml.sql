
-- query1
with cte as (
    SELECT p0.dt FROM tbl_0 AS p0 LEFT OUTER JOIN tbl_1 AS p1 ON p1.dt=p1.dt
    LEFT OUTER JOIN tbl_2 AS p2 ON p2.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p3 ON p3.dt=p1.dt
    LEFT OUTER JOIN tbl_4 AS p4 ON p4.dt=p1.dt
    LEFT OUTER JOIN tbl_5 AS p5 ON p5.dt=p1.dt
    LEFT OUTER JOIN tbl_6 AS p6 ON p6.dt=p1.dt
    LEFT OUTER JOIN tbl_7 AS p7 ON p7.dt=p1.dt
    LEFT OUTER JOIN tbl_8 AS p8 ON p8.dt=p1.dt
    LEFT OUTER JOIN tbl_9 AS p9 ON p9.dt=p1.dt
    LEFT OUTER JOIN tbl_10 AS p10 ON p10.dt=p1.dt
    LEFT OUTER JOIN tbl_11 AS p11 ON p11.dt=p1.dt
    LEFT OUTER JOIN tbl_12 AS p12 ON p12.dt=p1.dt
    LEFT OUTER JOIN tbl_13 AS p13 ON p13.dt=p1.dt
    LEFT OUTER JOIN tbl_14 AS p14 ON p14.dt=p1.dt
    LEFT OUTER JOIN tbl_15 AS p15 ON p15.dt=p1.dt
    LEFT OUTER JOIN tbl_16 AS p16 ON p16.dt=p1.dt
    LEFT OUTER JOIN tbl_17 AS p17 ON p17.dt=p1.dt
    LEFT OUTER JOIN tbl_18 AS p18 ON p18.dt=p1.dt
    LEFT OUTER JOIN tbl_19 AS p19 ON p19.dt=p1.dt
)
select * from cte
union all
select * from cte
union all
select * from cte
union all
select * from cte
union all
select * from cte;

with cte as (
    SELECT p0.dt FROM tbl_0 AS p0 LEFT OUTER JOIN tbl_1 AS p1 ON p1.dt=p1.dt
    LEFT OUTER JOIN tbl_2 AS p2 ON p2.dt=p1.dt
)
select * from cte
union all
select * from cte
union all
select * from cte
union all
select * from cte
union all
select * from cte;

with cte as (
    SELECT p0.dt FROM tbl_0 AS p0 LEFT OUTER JOIN tbl_1 AS p1 ON p1.dt=p1.dt
    LEFT OUTER JOIN tbl_2 AS p2 ON p2.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p3 ON p3.dt=p1.dt
)
select * from cte
union all
select * from cte
union all
select * from cte
union all
select * from cte
union all
select * from cte;

with cte as (
    SELECT p0.dt FROM tbl_0 AS p0 LEFT OUTER JOIN tbl_1 AS p1 ON p1.dt=p1.dt
    LEFT OUTER JOIN tbl_2 AS p2 ON p2.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p3 ON p3.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p31 ON p31.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p32 ON p32.dt=p1.dt
    LEFT OUTER JOIN tbl_4 AS p4 ON p4.dt=p1.dt
    LEFT OUTER JOIN tbl_5 AS p5 ON p5.dt=p3.dt
    LEFT OUTER JOIN tbl_6 AS p6 ON p6.dt=p2.dt
    LEFT OUTER JOIN tbl_7 AS p7 ON p7.dt=p1.dt
    LEFT OUTER JOIN tbl_8 AS p8 ON p8.dt=p2.dt
)
select * from cte
union all
select * from cte
union all
select * from cte
union all
select * from cte
union all
select * from cte;

with cte as (
    SELECT p0.dt FROM tbl_0 AS p0 LEFT OUTER JOIN tbl_1 AS p1 ON p1.dt=p1.dt
    LEFT OUTER JOIN tbl_2 AS p2 ON p2.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p3 ON p3.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p31 ON p31.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p32 ON p32.dt=p1.dt
    LEFT OUTER JOIN tbl_4 AS p4 ON p4.dt=p1.dt
    LEFT OUTER JOIN tbl_5 AS p5 ON p5.dt=p3.dt
    LEFT OUTER JOIN tbl_6 AS p6 ON p6.dt=p2.dt
    LEFT OUTER JOIN tbl_7 AS p7 ON p7.dt=p1.dt
    LEFT OUTER JOIN tbl_8 AS p8 ON p8.dt=p2.dt
    LEFT OUTER JOIN tbl_9 AS p9 ON p9.dt=p1.dt
    LEFT OUTER JOIN tbl_10 AS p10 ON p10.dt=p1.dt
    LEFT OUTER JOIN tbl_11 AS p11 ON p11.dt=p1.dt
    LEFT OUTER JOIN tbl_12 AS p12 ON p12.dt=p10.dt
    LEFT OUTER JOIN tbl_13 AS p13 ON p13.dt=p11.dt
    LEFT OUTER JOIN tbl_14 AS p14 ON p14.dt=p1.dt
    LEFT OUTER JOIN tbl_15 AS p15 ON p15.dt=p1.dt
    LEFT OUTER JOIN tbl_16 AS p16 ON p16.dt=p1.dt
    LEFT OUTER JOIN tbl_17 AS p17 ON p17.dt=p1.dt
    LEFT OUTER JOIN tbl_18 AS p18 ON p18.dt=p1.dt
    LEFT OUTER JOIN tbl_19 AS p19 ON p19.dt=p1.dt
)
select * from cte
union all
select * from cte
union all
select * from cte
union all
select * from cte
union all
select * from cte;

with cte as (
    SELECT p0.dt FROM tbl_0 AS p0 LEFT OUTER JOIN tbl_1 AS p1 ON p1.dt=p1.dt
    LEFT OUTER JOIN tbl_2 AS p2 ON p2.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p3 ON p3.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p31 ON p31.dt=p1.dt
    LEFT OUTER JOIN tbl_3 AS p32 ON p32.dt=p1.dt
    LEFT OUTER JOIN tbl_4 AS p4 ON p4.dt=p1.dt
    LEFT OUTER JOIN tbl_5 AS p5 ON p5.dt=p3.dt
    LEFT OUTER JOIN tbl_6 AS p6 ON p6.dt=p2.dt
    LEFT OUTER JOIN tbl_7 AS p7 ON p7.dt=p1.dt
    LEFT OUTER JOIN tbl_8 AS p8 ON p8.dt=p2.dt
    LEFT OUTER JOIN tbl_9 AS p9 ON p9.dt=p1.dt
    LEFT OUTER JOIN tbl_10 AS p10 ON p10.dt=p1.dt
    LEFT OUTER JOIN tbl_11 AS p11 ON p11.dt=p1.dt
    LEFT OUTER JOIN tbl_12 AS p12 ON p12.dt=p10.dt
    LEFT OUTER JOIN tbl_13 AS p13 ON p13.dt=p11.dt
    LEFT OUTER JOIN tbl_14 AS p14 ON p14.dt=p1.dt
    LEFT OUTER JOIN tbl_15 AS p15 ON p15.dt=p1.dt
    LEFT OUTER JOIN tbl_16 AS p16 ON p16.dt=p1.dt
    LEFT OUTER JOIN tbl_17 AS p17 ON p17.dt=p1.dt
    LEFT OUTER JOIN tbl_18 AS p18 ON p18.dt=p1.dt
    LEFT OUTER JOIN tbl_19 AS p19 ON p19.dt=p1.dt
)
select * from cte a1, cte a2, cte a3, cte a4 where a1.dt=a2.dt and a2.dt=a3.dt and a3.dt=a4.dt;


with cte as (
    SELECT p0.dt FROM tbl_0 AS p0  JOIN tbl_1 AS p1 ON p1.dt=p1.dt
     JOIN tbl_2 AS p2 ON p2.dt=p1.dt
     JOIN tbl_3 AS p3 ON p3.dt=p1.dt
     JOIN tbl_3 AS p31 ON p31.dt=p1.dt
     JOIN tbl_3 AS p32 ON p32.dt=p1.dt
     JOIN tbl_4 AS p4 ON p4.dt=p1.dt
     JOIN tbl_5 AS p5 ON p5.dt=p3.dt
     JOIN tbl_6 AS p6 ON p6.dt=p2.dt
     JOIN tbl_7 AS p7 ON p7.dt=p1.dt
     JOIN tbl_8 AS p8 ON p8.dt=p2.dt
     JOIN tbl_9 AS p9 ON p9.dt=p1.dt
     JOIN tbl_10 AS p10 ON p10.dt=p1.dt
     JOIN tbl_11 AS p11 ON p11.dt=p1.dt
     JOIN tbl_12 AS p12 ON p12.dt=p10.dt
     JOIN tbl_13 AS p13 ON p13.dt=p11.dt
     JOIN tbl_14 AS p14 ON p14.dt=p1.dt
     JOIN tbl_15 AS p15 ON p15.dt=p1.dt
     JOIN tbl_16 AS p16 ON p16.dt=p1.dt
     JOIN tbl_17 AS p17 ON p17.dt=p1.dt
     JOIN tbl_18 AS p18 ON p18.dt=p1.dt
     JOIN tbl_19 AS p19 ON p19.dt=p1.dt
)
select * from cte a1, cte a2, cte a3, cte a4 where a1.dt=a2.dt and a2.dt=a3.dt and a3.dt=a4.dt;